

Зоны ответственности:

Центральный координатор всех апсершнов: UpsertionService

Интерфейс стратегии апсершна по магазину : MerchUpserter

Существует 2 принципиально разных способа получения данных:
данные добываются приложением - экстрактивный способ.
данные приходят извне - реактивный способ.

Реактивный апсершн (в ответ на событие): ReactiveMerchUpserter

Экстрактивный апсершн по расписанию: ScheduledMerchUpserter

С перспективой разрастания проекта до использования реактивного
способа, рассмотрим для начала экстрактивный.

Извлечение данных и преобразование их в удобоваримые Dto:
MerchDataExtractor

Принимая данные от экстрактора, отвечает за upsert в узком
смысле этого слова (т.е. только вставка и обновление, без
извлечения данных): MerchDataConsumer

Дальше планировать общие классы и интерфейсы не вижу смысла.
Пусть парсинг, скрапинг и прочее будут для каждого магазина
организованы по своему.


TODO:

Зарегистрировать где надо OnShutdown.
Проверить работу логгера в месте где происходит возобновление работы.
Проверить бы исправность сохранения кук и работы CitilinkScraper
в целом.

Attention:
1. CitilinkParsingExecutionStateRepository и CitilinkExtractorStorageStateRepository
не подразумевают параллельного запроса к данным. См. ModuleNotes Repository
составляющей.