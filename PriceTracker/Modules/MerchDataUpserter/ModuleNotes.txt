

Зоны ответственности:

Центральный координатор всех апсершнов: UpsertionService

Интерфейс стратегии апсершна по магазину : MerchUpserter

Существует 2 принципиально разных способа получения данных:
данные добываются приложением - экстрактивный способ.
данные приходят извне - реактивный способ.

Реактивный апсершн (в ответ на событие): ReactiveMerchUpserter

Экстрактивный апсершн по расписанию: ScheduledMerchUpserter

С перспективой разрастания проекта до использования реактивного
способа, рассмотрим для начала экстрактивный.

Извлечение данных и преобразование их в удобоваримые Dto:
MerchDataExtractor

Принимая данные от экстрактора, отвечает за upsert в узком
смысле этого слова (т.е. только вставка и обновление, без
извлечения данных): MerchDataConsumer

Дальше планировать общие классы и интерфейсы не вижу смысла.
Пусть парсинг, скрапинг и прочее будут для каждого магазина
организованы по своему.


TODO:


Добавить бы обработку исключительных, "непонятных" загрузок страниц с ситилинка.
Покрыть бы комментариями логику и пересмотреть корректность разделения
ответственности между частями модуля.

Товары, у которых не указана цена, у которых написано "нет в наличии",
заносятся в БД с отметкой цены равной, вроде бы, минимально возможному
по мантиссе значению double. ИСПРАВИТЬ!

Attention:
1. CitilinkParsingExecutionStateRepository и CitilinkExtractorStorageStateRepository
не подразумевают параллельного запроса к данным. См. ModuleNotes Repository
составляющей.

